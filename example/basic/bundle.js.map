{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./example/basic/index.ts","webpack:///./src/core.ts","webpack:///./src/utils.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","core_1","canvas","document","createElement","width","height","ctx","getContext","image","Image","body","appendChild","src","crossOrigin","onload","fillStyle","fillRect","drawImage","color_picker","ColorPicker","range","scale","magnifier","get_magnifier","window","addEventListener","ev","x","y","style","position","top","left","cursor","append","utils_1","config","this","current_color","Math","ceil","magnifier_width","magnifier_height","get_pixels","background_color","_this","floor","result","CanvasRenderingContext2D","getImageData","data","WebGLRenderingContext","pixels","Uint8Array","temp","readPixels","RGBA","UNSIGNED_BYTE","halfHeight","bytesPerRow","topOffset","bottomOffset","set","subarray","copyWithin","split","curryRight","chunk","flow","map","pixel","index","current_top","x_offset","y_offset","pos","clamp","is_out_of_stage","flatten","get_current_color","get_x_index_of_area","area_index","get_y_index_of_area","get_real_x","x_index_of_area","get_real_y","y_index_of_area","get_x_of_area","get_y_of_area","datas","magnifier_ctx","clearRect","draw_to_ctx","j","push","forEach","magnifier_imageData","createImageData","real_x","real_y","putImageData","select","save","strokeStyle","lineWidth","strokeRect","restore","get_color_picker","cloneDeep","undefined","length","result_1","_i","value_1","ele","_a","keys_1","keys","funcs","funcs_1","func","low","max","params","caller","param","apply","reverse","arr","size","slice","tmp_array","arr_1","arr_2","value_2","_value"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\"use strict\";\nexports.__esModule = true;\nvar core_1 = require(\"../../src/core\");\n// const img = require('../scenery.jpeg');\nvar canvas = document.createElement('canvas');\ncanvas.width = 800;\ncanvas.height = 800;\nvar ctx = canvas.getContext('2d');\nvar image = new Image();\ndocument.body.appendChild(canvas);\nimage.src = 'https://static.codemao.cn/kitten/H1y1S6lxV';\nimage.crossOrigin = '';\nimage.onload = function () {\n    ctx.fillStyle = 'black';\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n    ctx.drawImage(image, 0, 0);\n    ctx.fillStyle = 'red';\n    ctx.fillRect(0, 0, 100, 100);\n    ctx.fillStyle = 'green';\n    ctx.fillRect(200, 300, 200, 300);\n    var color_picker = new core_1.ColorPicker(canvas, { range: 30, scale: 3 });\n    var magnifier = color_picker.get_magnifier(0, 0);\n    var onmousemove = function (ev) {\n        magnifier = color_picker.get_magnifier(ev.x, ev.y);\n        magnifier.style.position = 'absolute';\n        magnifier.style.top = ev.y - magnifier.height / 2 + \"px\";\n        magnifier.style.left = ev.x - magnifier.width / 2 + \"px\";\n        magnifier.style.cursor = 'none';\n        document.body.append(magnifier);\n    };\n    window.addEventListener(\"mousemove\", onmousemove);\n};\n","\"use strict\";\nexports.__esModule = true;\nvar utils_1 = require(\"./utils\");\nvar magnifier = document.createElement('canvas');\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(canvas, config) {\n        if (config === void 0) { config = { range: 40, scale: 4 }; }\n        this.magnifier = magnifier;\n        this.current_color = '';\n        config.range = Math.ceil(config.range);\n        config.range = config.range % 2 ? config.range : config.range + 1;\n        config.scale = Math.ceil(config.scale);\n        this.canvas = canvas;\n        this.config = config;\n        var magnifier_width = this.config.scale * this.config.range;\n        var magnifier_height = magnifier_width;\n        this.magnifier.width = magnifier_width;\n        this.magnifier.height = magnifier_height;\n    }\n    ColorPicker.prototype.get_pixels = function (x, y, range, background_color) {\n        var _this = this;\n        if (range === void 0) { range = this.config.range; }\n        if (background_color === void 0) { background_color = [255, 255, 255, 255]; }\n        var left = Math.floor(x - (range - 1) / 2);\n        var top = Math.floor(y - (range - 1) / 2);\n        var ctx = this.canvas.getContext('2d') || this.canvas.getContext('webgl');\n        var result = [];\n        if (ctx instanceof CanvasRenderingContext2D) {\n            result = ctx.getImageData(left, top, range, range).data;\n        }\n        else if (ctx instanceof WebGLRenderingContext) {\n            top = Math.floor(this.canvas.height - y - 1 - (range - 1) / 2);\n            var pixels = new Uint8Array(range * range * 4);\n            var temp = new Uint8Array(range * 4);\n            ctx.readPixels(left, top, range, range, ctx.RGBA, ctx.UNSIGNED_BYTE, pixels);\n            var halfHeight = range / 2 | 0; // the | 0 keeps the result an int\n            var bytesPerRow = range * 4;\n            // make a temp buffer to hold one row\n            for (var i = 0; i < halfHeight; ++i) {\n                var topOffset = i * bytesPerRow;\n                var bottomOffset = (range - i - 1) * bytesPerRow;\n                // make copy of a row on the top half\n                temp.set(pixels.subarray(topOffset, topOffset + bytesPerRow));\n                // copy a row from the bottom half to the top\n                pixels.copyWithin(topOffset, bottomOffset, bottomOffset + bytesPerRow);\n                // copy the copy of the top half row to the bottom half\n                pixels.set(temp, bottomOffset);\n            }\n            result = pixels;\n        }\n        // set background color\n        var is_out_of_stage = function (index) {\n            var current_top = Math.floor(y - (range - 1) / 2);\n            var x_offset = index % _this.config.range;\n            var y_offset = Math.floor(index / _this.config.range);\n            var pos = {\n                x: left + x_offset,\n                y: current_top + y_offset,\n            };\n            if (utils_1.clamp(pos.x, 0, _this.canvas.width - 1) !== pos.x) {\n                return true;\n            }\n            else if (utils_1.clamp(pos.y, 0, _this.canvas.height - 1) !== pos.y) {\n                return true;\n            }\n            return false;\n        };\n        var split = utils_1.curryRight(utils_1.chunk)(4);\n        var get_background_color = function (pixels) {\n            return pixels.map(function (pixel, index) {\n                if (is_out_of_stage(index)) {\n                    return [255, 255, 255, 255];\n                }\n                return pixel;\n            });\n        };\n        return utils_1.flow([\n            split,\n            get_background_color,\n            utils_1.flatten,\n        ])(result);\n    };\n    ColorPicker.prototype.get_current_color = function () {\n        return this.current_color;\n    };\n    ColorPicker.prototype.get_x_index_of_area = function (area_index) {\n        return area_index % this.config.range;\n    };\n    ColorPicker.prototype.get_y_index_of_area = function (area_index) {\n        return Math.floor(area_index / this.config.range);\n    };\n    ColorPicker.prototype.get_real_x = function (x_index_of_area) {\n        return x_index_of_area * this.config.scale;\n    };\n    ColorPicker.prototype.get_real_y = function (y_index_of_area) {\n        return y_index_of_area * this.config.scale;\n    };\n    ColorPicker.prototype.get_x_of_area = function (area_index) {\n        return this.get_real_x(this.get_x_index_of_area(area_index));\n    };\n    ColorPicker.prototype.get_y_of_area = function (area_index) {\n        return this.get_real_y(this.get_y_index_of_area(area_index));\n    };\n    ColorPicker.prototype.get_magnifier = function (x, y) {\n        var _this = this;\n        x = Math.floor(x);\n        y = Math.floor(y);\n        var top = Math.floor(x - (this.config.range - 1) / 2);\n        var left = Math.floor(y - (this.config.range - 1) / 2);\n        var datas = this.get_pixels(x, y);\n        var magnifier_ctx = this.magnifier.getContext('2d');\n        // reset canvas\n        magnifier_ctx.clearRect(0, 0, this.magnifier.width, this.magnifier.height);\n        var split = utils_1.curryRight(utils_1.chunk)(4);\n        var amplify = function (pixels) {\n            return pixels.map(function (pixel) {\n                var result = [];\n                for (var i = 0; i < _this.config.scale; i++) {\n                    for (var j = 0; j < _this.config.scale; j++) {\n                        result.push(pixel[0]);\n                        result.push(pixel[1]);\n                        result.push(pixel[2]);\n                        result.push(pixel[3]);\n                    }\n                }\n                return result;\n            });\n        };\n        var draw = function (pixels) {\n            return pixels.forEach(function (pixel, index) {\n                var magnifier_imageData = magnifier_ctx.createImageData(_this.config.scale, _this.config.scale);\n                magnifier_imageData.data.set(pixel);\n                var real_x = _this.get_x_of_area(index);\n                var real_y = _this.get_y_of_area(index);\n                magnifier_ctx.putImageData(magnifier_imageData, real_x, real_y);\n            });\n        };\n        var draw_selecting = function () {\n            var real_x = _this.get_real_x(x - top);\n            var real_y = _this.get_real_y(y - left);\n            magnifier_ctx.save();\n            magnifier_ctx.strokeStyle = '#000000';\n            magnifier_ctx.lineWidth = 1;\n            magnifier_ctx.strokeRect(real_x - 1, real_y - 1, _this.config.scale + 2, _this.config.scale + 2);\n            magnifier_ctx.strokeStyle = '#FFFFFF';\n            magnifier_ctx.lineWidth = 1;\n            magnifier_ctx.strokeRect(real_x - 2, real_y - 2, _this.config.scale + 4, _this.config.scale + 4);\n            magnifier_ctx.restore();\n        };\n        var select_color = function () {\n            var pixel = _this.get_pixels(x, y, 1);\n            // this.current_color = rgb_to_hex(pixel[0], pixel[1], pixel[2]);\n        };\n        var draw_to_ctx = utils_1.flow([\n            split,\n            amplify,\n            draw,\n        ]);\n        var select = utils_1.flow([\n            draw_selecting,\n            select_color,\n        ]);\n        draw_to_ctx(datas);\n        select();\n        return this.magnifier;\n    };\n    return ColorPicker;\n}());\nexports.ColorPicker = ColorPicker;\nfunction get_color_picker(range, scale) {\n    var canvas = document.createElement('canvas');\n    return new ColorPicker(canvas, { range: range, scale: scale });\n}\nexports.get_color_picker = get_color_picker;\n","\"use strict\";\nexports.__esModule = true;\nfunction cloneDeep(value) {\n    if (typeof value !== 'object') {\n        return value;\n    }\n    if (value.length != undefined) {\n        var result_1 = [];\n        for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {\n            var ele = value_1[_i];\n            result_1.push(cloneDeep(ele));\n        }\n        return result_1;\n    }\n    var keys = Object.keys(value);\n    var result = {};\n    for (var _a = 0, keys_1 = keys; _a < keys_1.length; _a++) {\n        var key = keys_1[_a];\n        if (typeof value[key] === 'object') {\n            result[key] = cloneDeep(value[key]);\n        }\n        else {\n            result[key] = value[key];\n        }\n    }\n    return result;\n}\nexports.cloneDeep = cloneDeep;\nfunction flow(funcs) {\n    // console.log('=============flow=============');\n    return function (value) {\n        var result = cloneDeep(value);\n        for (var _i = 0, funcs_1 = funcs; _i < funcs_1.length; _i++) {\n            var func = funcs_1[_i];\n            // console.log('                 ');\n            // console.log('param', result);\n            // console.log('                 ');\n            // console.log('result before', result);\n            // console.log('                 ');\n            // console.log('func', func);\n            result = func(result);\n            // console.log('                 ');\n            // console.log('result after', result);\n            // console.log('result', result);\n        }\n        return result;\n    };\n}\nexports.flow = flow;\nfunction clamp(value, low, max) {\n    if (value < low) {\n        return low;\n    }\n    else if (value > max) {\n        return max;\n    }\n    return value;\n}\nexports.clamp = clamp;\nfunction curryRight(func) {\n    var params = [];\n    var caller = function (param) {\n        if (params.length < func.length) {\n            params.push(param);\n        }\n        if (params.length === func.length) {\n            return func.apply(void 0, cloneDeep(params).reverse());\n        }\n        return caller;\n    };\n    return caller;\n}\nexports.curryRight = curryRight;\nfunction chunk(arr, size) {\n    if (size <= 0) {\n        return [];\n    }\n    if (size >= arr.length) {\n        return [arr.slice()];\n    }\n    var result = [];\n    var tmp_array = [];\n    for (var _i = 0, arr_1 = arr; _i < arr_1.length; _i++) {\n        var value = arr_1[_i];\n        if (tmp_array.length === size) {\n            result.push(tmp_array);\n            tmp_array = [value];\n        }\n        else {\n            tmp_array.push(value);\n        }\n    }\n    result.push(tmp_array);\n    return result;\n}\nexports.chunk = chunk;\nfunction flatten(arr) {\n    var result = [];\n    for (var _i = 0, arr_2 = arr; _i < arr_2.length; _i++) {\n        var value = arr_2[_i];\n        if (value.length != undefined) {\n            for (var _a = 0, value_2 = value; _a < value_2.length; _a++) {\n                var _value = value_2[_a];\n                result.push(_value);\n            }\n        }\n        else {\n            result.push(value);\n        }\n    }\n    return result;\n}\nexports.flatten = flatten;\n"],"sourceRoot":""}